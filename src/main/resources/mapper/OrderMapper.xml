<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scoprion.mall.backstage.mapper.OrderMapper">
    <!--订单列表-->
    <select id="listPage" resultType="com.scoprion.mall.domain.Order">
        SELECT
        id,
        orderNo,
        goodSnapShotId,
        deliveryId,
        orderType,
        createDate
        FROM t_order WHERE 1=1
        <if test="searchKey!=null">AND CONCAT(goodName,postCode,address,phone,recipients) LIKE searchKey</if>
        <if test="payType!=null">AND payType =#{payType}</if>
        <if test="orderType!=null">AND orderType =#{orderType}</if>
        <if test="orderStatus!=null">AND orderStatus =#{orderStatus}</if>

        <if test="startDate!=null and endDate!=null">AND createDate BETWEEN #{startDate} AND #{endDate}</if>
        <if test="startDate==null and endDate!=null">AND createDate BETWEEN '1970-01-01' AND #{endDate}</if>
        <if test="startDate!=null and endDate==null">AND createDate BETWEEN #{startDate} AND now()</if>
    </select>

    <!--详情-->
    <select id="findById" resultType="com.scoprion.mall.domain.Order">
        SELECT * FROM t_order WHERE id=#{id}
    </select>

    <!--修改订单-->
    <update id="modify" parameterType="com.scoprion.mall.domain.Order">
        UPDATE t_order SET
        <if test="orderNo!=null">orderNo=#{orderNo},</if>
        <if test="goodSnapShotId!=null">goodSnapShotId=#{goodSnapShotId},</if>
        <if test="deliveryId!=null">deliveryId=#{deliveryId},</if>
        <if test="orderStatus!=null">orderStatus=#{orderStatus},</if>
        <if test="orderType!=null">orderType=#{orderType},</if>
        <if test="createDate!=null">createDate=#{createDate},</if>
        <if test="userId!=null">userId=#{userId},</if>
        <if test="payType!=null">payType=#{payType},</if>
        <if test="message!=null">message=#{message},</if>
        <if test="goodFee!=null">goodFee=#{goodFee},</if>
        <if test="ticketFee!=null">ticketFee=#{ticketFee},</if>
        <if test="totalFee!=null">totalFee=#{totalFee},</if>
        <if test="payDate!=null">payDate=#{payDate},</if>
        <if test="deliveryDate!=null">deliveryDate=#{deliveryDate},</if>
        <if test="recipients!=null">recipients=#{recipients},</if>
        <if test="phone!=null">phone=#{phone},</if>
        <if test="province!=null">province=#{province},</if>
        <if test="city!=null">city=#{city},</if>
        <if test="area!=null">area=#{area},</if>
        <if test="address!=null">address=#{address},</if>
        <if test="postCode!=null">postCode=#{postCode},</if>
        <if test="goodName!=null">goodName=#{goodName},</if>
        <if test="count!=null">count=#{count},</if>
        <if test="wxOrderNo!=null">wxOrderNo=#{wxOrderNo},</if>
        <if test="goodId!=null">goodId=#{goodId},</if>
        updateDate=now()
        WHERE id=#{id}
    </update>
</mapper>